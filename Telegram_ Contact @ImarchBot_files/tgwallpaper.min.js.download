var TWallpaper=function(){var h=0,g=0,C=0,H=1E3/15,x=[],y=null,D=null,u=[],k=[0,.25,.5,.75,1,1.5,2,2.5,3,3.5,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,18.3,18.6,18.9,19.2,19.5,19.8,20.1,20.4,20.7,21,21.3,21.6,21.9,22.2,22.5,22.8,23.1,23.4,23.7,24,24.3,24.6,24.9,25.2,25.5,25.8,26.1,26.3,26.4,26.5,26.6,26.7,26.8,26.9,27],c={init:function(a){u=[];var b=a.getAttribute("data-colors")||"";b&&(b=b.split(","));for(var d=0;d<b.length;d++)u.push(c.hexToRgb(b[d]));c._hc||(c._hc=document.createElement("canvas"),c._hc.width=50,c._hc.height=50,c._hctx=c._hc.getContext("2d"));c._canvas=a;c._ctx=c._canvas.getContext("2d");c.update()},hexToRgb:function(a){return(a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a))?{r:parseInt(a[1],16),g:parseInt(a[2],16),b:parseInt(a[3],16)}:null},getPositions:function(a){for(var b=[{x:.8,y:.1},{x:.6,y:.2},{x:.35,y:.25},{x:.25,y:.6},{x:.2,y:.9},{x:.4,y:.8},{x:.65,y:.75},{x:.75,y:.4}];0<a;)b.push(b.shift()),a--;a=[];for(var d=0;d<b.length;d+=2)a.push(b[d]);return a},draw:function(){if(0<x.length){var a=x.shift();c._hctx.putImageData(a,0,0);c._ctx.drawImage(c._hc,0,0,50,50)}else clearInterval(y)},update:function(){clearInterval(y);var a=c.getPositions(h%8);a=c.drawGradient(50,50,u,a);c._hctx.putImageData(a,0,0);c._ctx.drawImage(c._hc,0,0,50,50)},rotate:function(){clearInterval(y);x=[];var a=c.getPositions(h%8);h++;var b=c.getPositions(h%8),d=(b[0].x-a[0].x)/27,z=(b[0].y-a[0].y)/27,A=(b[1].x-a[1].x)/27,p=(b[1].y-a[1].y)/27,q=(b[2].x-a[2].x)/27,v=(b[2].y-a[2].y)/27,r=(b[3].x-a[3].x)/27;b=(b[3].y-a[3].y)/27;for(var e=0;60>e;e++)x.push(c.drawGradient(50,50,u,[{x:a[0].x+d*k[e],y:a[0].y+z*k[e]},{x:a[1].x+A*k[e],y:a[1].y+p*k[e]},{x:a[2].x+q*k[e],y:a[2].y+v*k[e]},{x:a[3].x+r*k[e],y:a[3].y+b*k[e]}]));y=setInterval(c.draw,1E3/30)},animate:function(a){if(a){a=+Date.now();if(document.hasFocus()&&!(a-C<H)){C=a;a=c.getPositions(h%8);g++;g%=180;h++;var b=c.getPositions(h%8);g?(h--,a=[{x:a[0].x+(b[0].x-a[0].x)/180*g,y:a[0].y+(b[0].y-a[0].y)/180*g},{x:a[1].x+(b[1].x-a[1].x)/180*g,y:a[1].y+(b[1].y-a[1].y)/180*g},{x:a[2].x+(b[2].x-a[2].x)/180*g,y:a[2].y+(b[2].y-a[2].y)/180*g},{x:a[3].x+(b[3].x-a[3].x)/180*g,y:a[3].y+(b[3].y-a[3].y)/180*g}]):a=b;a=c.drawGradient(50,50,u,a);c._hctx.putImageData(a,0,0);c._ctx.drawImage(c._hc,0,0,50,50)}D=requestAnimationFrame(c.animate)}else cancelAnimationFrame(D)},drawGradient:function(a,b,d,z){for(var A=c._hctx.createImageData(a,b),p=A.data,q=0,v=0;v<b;v++)for(var r=v/b-.5,e=r*r,B=0;B<a;B++){var t=B/a-.5,l=.35*Math.sqrt(t*t+e);l=l*l*6.4;var m=Math.sin(l),w=Math.cos(l);l=Math.max(0,Math.min(1,.5+t*w-r*m));t=Math.max(0,Math.min(1,.5+t*m+r*w));for(var E=w=m=0,F=0,n=0;n<d.length;n++){var f=l-z[n].x,G=t-z[n].y;f=Math.max(0,.9-Math.sqrt(f*f+G*G));f*=f*f*f;m+=f;w+=f*d[n].r/255;E+=f*d[n].g/255;F+=f*d[n].b/255}p[q++]=w/m*255;p[q++]=E/m*255;p[q++]=F/m*255;p[q++]=255}return A}};return c}();